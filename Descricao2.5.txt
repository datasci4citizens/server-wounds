CID_WOUND = 4168335
CID_WOUND_MORPH = 4029919
CID_WOUND_TYPE = 43055265
CID_EHR = 32817
CID_HEIGHT = 607590
CID_WEIGHT = 4099154
CID_CENTIMETER = 8582
CID_KILOGRAM = 9529
CID_SMOKE_FREQUENCY = 1586169
CID_DRINK_FREQUENCY = 1586201
CID_CONDITION_ACTIVE = 32902
CID_CONDITION_INACTIVE = 32906
CID_SURFACE_REGION = 4027908
CID_WOUND_LOCATION = 765364
CID_WOUND_IMAGE = 36031251
CID_WOUND_PHOTOGRAPHY = 40486415
CID_UTF8 = 32678
CID_PORTUGUESE = 4181536
CID_WOUND_IMAGE_ANALYSIS = 4076808
CID_CONDITION_RELEVANT_TO = 46233685
CID_PK_CONDITION_OCCURRENCE = 1147127
CID_PK_PROCEDURE_OCCURRENCE = 1147082
# https://athena.ohdsi.org/search-terms/terms/1033739
# https://athena.ohdsi.org/search-terms/terms/4270431
CID_WOUND_LENGTH = 3041292
CID_WOUND_WIDTH = 3042480
CID_EXUDATE_AMOUNT = 3038234
CID_EXUDATE_APPEARANCE = 43055255
CID_WOUND_APPEARANCE = 43055002
CID_WOUND_EDGE_DESCRIPTION = 43055269
CID_WOUND_SKIN_AROUND = CID_EXUDATE_APPEARANCE? # No front end usava o mesmo tipo 
CID_FEVER = 437663
CID_NEGATIVE = 9189
CID_POSITIVE =	9191
CID_PAIN_SEVERITY = 21499037
CID_DEGREE_FINDING = 4154199?
CID_WOUND_MANAGEMENT_NOTE = 36031413
CID_GENERIC_NOTE = 3030653
CID_WOUND_CARE_DRESSING_CHANGE = 4256346


Todos os *_TYPE_cid possuem valor  CID_EHR
CONTAINER Specialists {
    (l:LOCATION  {
        city  = city_character
        state = state_character
    }),
    (s:PROVIDER  {
        provider_id   = specialist_id  
        provider_name = specialist_name
        year_of_birth = birthday
        specialty_cid = speciality
        location_id 
    })
}
Comorbidities = MATCH (a:CONCEPT {class: ID_DISORDER, domain: ID_CONDITION }) RETURN a



CONTAINER PatientComorbidities {
    WHERE comorbidity_id in Comorbidities,
    :CONDITION_OCCURRENCE {
        person_id = patient_id
        condition_cid = comorbidity_id
        + condition_start_date
    }
}

CONTAINER Patient {
    TABLE PERSON {
        person_id = patient_id  
        provider_id = specialist_id (FK PROVIDER)
        care_site_id = hospital_registration   (FK CARE_SITE)
        birth_datetime  = birthday
        gender_cid    = gender
		
        name = name # n達o omop
        email = email # n達o omop
        phone_number = phone_number # n達o omop
        accept_tcl = accept_tcl # n達o omop
    }
    TABLE MEASUREMENT {
        person_id =  patient_id
        value_as_number = height
        measurement_cid = CID_HEIGHT
        unit_cid        = CID_CENTIMETER
        measurement_date = UPDATE_AT()
    },
    TABLE MEASUREMENT {
        person_id =  patient_id
        value_as_number = weight
        measurement_cid = CID_WEIGHT
        unit_cid = CID_KILOGRAM
        measurement_date = UPDATE_AT()
    }, 
    TABLE OBSERVATION {
        person_id = patient_id
        observation_cid = CID_SMOKE_FREQUENCY
        observation_date = UPDATE_AT()
        value_as_cid = smoke_frequency WHERE ( CID_SMOKE_FREQUENCY -[Has Answer]-> smoke_frequency )
    }
    TABLE OBSERVATION {
        person_id = patient_id
        observation_cid = CID_DRINK_FREQUENCY
        observation_date = UPDATE_AT()
        value_as_cid = drink_frequency WHERE ( CID_DRINK_FREQUENCY -[Has Answer]-> drink_frequency )
    }


} 
    

CONTAINER Wound {
    TABLE CONDITION_OCCURRENCE {
        condition_occurrence_id = wound_id
        person_id               = patient_id  
        provider_id             = specialist_id
        condition_cid           = type  
        condition_start_date    = start_date
        condition_end_date      = end_date
        condition_status_cid    = is_active 
    }
    
    TABLE OBSERVATION {
        person_id            = patient_id
        observation_cid      = CID_WOUND_LOCATION 
        observation_date     = UPDATE_AT()
        value_as_cid         = region
        observation_event_id =  wound_id 
    	obs_event_field_cid = CID_PK_CONDITION_OCCURRENCE
    }

    TABLE NOTE {
	    person_id      = patient_id
        note_class_cid = CID_WOUND_IMAGE
        encoding_cid   = CID_UTF8
        language_cid   = CID_PORTUGUESE
        note_text      = image_id
        note_event_id  = wound_id 
    }
}



CONTAINER TrackingRecords {
    WITH patient_id = (SELECT co.id CONTAINER CONDITION_OCCURRENCE WHERE  id = wound_id )

    TABLE PROCEDURE_OCURRENCE {
        person_id               = patient_id
        procedure_occurrence_id = tracking_id 
        provider_id             = specialist_id  
        procedure_cid           = CID_WOUND_PHOTOGRAPHY
        procedure_date          = track_date 
    }  

    TABLE FACT_RELATION_SHIP {
        fact_id_1        = wound_id 
        relationship_cid = CID_CONDITION_RELEVANT_TO
        fact_id_2        = tracking_id 
    }
    TABLE NOTE {
        person_id = patient_id
        note_class_cid = CID_WOUND_IMAGE
        note_text = image_id
		note_event_id = tracking_id
    }

    TABLE MEASUREMENT {
        person_id            =  patient_id
        measurement_event_id = tracking_id
        value_as_number      = length
        measurement_cid      = CID_WOUND_LENGTH
        unit_cid             = CID_CENTIMETER
    },
    TABLE MEASUREMENT {
        value_as_number = width
        measurement_cid = CID_WOUND_WIDTH
        unit_cid = CID_CENTIMETER
    },
    TABLE MEASUREMENT {
        person_id            =  patient_id
        measurement_event_id = tracking_id		
        value_as_cid         = exudate_amount  WHERE ( CID_EXUDATE_AMOUNT -[Has Answer]-> exudate_amount ) 
        measurement_cid      = CID_EXUDATE_AMOUNT
    },
    TABLE MEASUREMENT {
        value_as_cid         = exudate_type  WHERE ( CID_EXUDATE_APPEARANCE -[Has Answer]-> exudate_type ) 
        measurement_cid      = CID_EXUDATE_APPEARANCE

    },    
    TABLE MEASUREMENT {
        value_as_cid         = tissue_type  WHERE ( CID_WOUND_APPEARANCE -[Has Answer]-> tissue_type ) 
        measurement_cid      = CID_WOUND_APPEARANCE
    },
    TABLE MEASUREMENT {
        value_as_cid         = wound_edges  WHERE ( CID_WOUND_EDGE_DESCRIPTION -[Has Answer]-> wound_edges ) 
        measurement_cid      = CID_WOUND_EDGE_DESCRIPTION
    },
    TABLE MEASUREMENT {
        value_as_cid         = skin_around  WHERE ( CID_WOUND_SKIN_AROUND -[Has Answer]-> skin_around ) 
        measurement_cid      = CID_WOUND_SKIN_AROUND
    },
    TABLE MEASUREMENT {
        value_as_cid         = had_a_fever WHERE had_a_fever in [CID_NEGATIVE, CID_POSITIVE]  
        measurement_cid      = CID_FEVER
    },
    TABLE MEASUREMENT {
        value_as_cid = pain_level  WHERE ( CID_PAIN_SEVERITY -[Has Answer]-> pain_level ) 
        measurement_cid = CID_PAIN_SEVERITY
    },
    TABLE MEASUREMENT {
        value_as_cid = dressing_changer_per_day  WHERE ( CID_DEGREE_FINDING -[Subsumes]-> dressing_changer_per_day ) 
        measurement_cid = CID_WOUND_CARE_DRESSING_CHANGE
    },
    
    TABLE NOTE {
        person_id = patient_id
        note_date = CREATED_AT()
        note_class_cid = CID_WOUND_MANAGEMENT_NOTE
        encoding_cid = CID_UTF8
        language_cid = CID_PORTUGUESE
        note_text = guidelines_to_patient
		note_event_id = tracking_id
		note_event_field_cid = CID_PK_PROCEDURE_OCCURRENCE
    }

    TABLE NOTE {
        person_id = patient_id
        note_date = CREATED_AT()
        note_class_cid = CID_GENERIC_NOTE
        encoding_cid = CID_UTF8
        language_cid = CID_PORTUGUESE
        note_text = extra_notes
		note_event_id = tracking_id
		note_event_field_cid = CID_PK_PROCEDURE_OCCURRENCE
    }
} 